{{ 'styles-tap-nvy.css' | asset_url | stylesheet_tag }}

<div class="main-taps__container main-taps__container--{{ section.id }}">

  <div class="main-taps__container-buttons">
    {% for block in section.blocks %}
      {% case block.type %}
        {% when 'tap' %}
          <button {{ block.shopify_attributes }} class="button-tap button-tap--{{ block.settings.button | handleize }}" data-button="{{ forloop.index }}">
            {{ block.settings.button }}
          </button>
      {% endcase %}
    {% endfor %}
  </div>

  <div class="main-taps__container-taps">
    {% for block in section.blocks %}
      {% case block.type %}
        {% when 'tap' %}

        {% if block.settings.button == 'OVERVIEW' %}

          <div {{ block.shopify_attributes }} id="tabs-{{ forloop.index }}" class="main-taps__container--overview main-taps__container--global main-taps__container--{{ block.settings.button | handleize }}">



            {% if product.metafields.custom.nvy_key_features %}
              <div class="product-nvy__details-features">
                <h3>KEY FEATURES</h3>
                <ul>
                  {% for file in product.metafields.custom.nvy_key_features.value %}
                    <li>
                      <img src="{{ file | img_url: 'master' }}" alt="{{ file.alt | escape }}">
                      <p>{{ file.alt }}</p>
                    </li>
                  {% endfor %}
                </ul>
              </div>
            {% endif %}

            
            <div class="main-taps__container">
              <div class="main-taps__container-information">
                {{ block.settings.content }}
              </div>
              <div class="main-taps__container-imagen">
                <img src="{{ block.settings.imagen | img_url: 'master' }}">
              </div>
            </div>
          </div>

        {% else %}

          <div {{ block.shopify_attributes }} id="tabs-{{ forloop.index }}" class="main-taps__container--global main-taps__container--{{ block.settings.button | handleize }}">  
            
            <div class="main-taps__container">
              <div class="main-taps__container-information">
                {{ block.settings.content }}
              </div>
              <div class="main-taps__container-imagen">
                <img src="{{ block.settings.imagen | img_url: 'master' }}">
              </div>
            </div>
          </div>
          
        {% endif %}
        
      {% endcase %}
    {% endfor %}
  </div>
  
</div>

<script>

  $(document).ready(function(){
    $('.main-taps__container--{{ section.id }} .main-taps__container-buttons button.button-tap').first().addClass('active-button');
    $('.main-taps__container--{{ section.id }} .main-taps__container-taps .main-taps__container--global').hide();
    $('.main-taps__container--{{ section.id }} .main-taps__container-taps .main-taps__container--global').first().show();

    const links = document.querySelectorAll('a');
    const targetText = 'download the user manual';
    
    links.forEach(link => {
      const text = link.textContent.trim().toLowerCase();
      if (text.includes(targetText)) {
        const icon = document.createElement('i');
        icon.className = 'fa-solid fa-download';
        link.prepend(icon);
        link.classList.add('user-manual-link');
      }
    });


    
  });

  $('.main-taps__container--{{ section.id }} .main-taps__container-buttons button.button-tap').click(function(){
    var number = $(this).attr('data-button');
    $('.main-taps__container--{{ section.id }} .main-taps__container-buttons button.button-tap').removeClass('active-button');
    $(this).addClass('active-button');
    $('.main-taps__container--{{ section.id }} .main-taps__container-taps .main-taps__container--global').hide();
    $('.main-taps__container--{{ section.id }} .main-taps__container-taps .main-taps__container--global#tabs-' + number).show();
  });




  
</script>

{% schema %}
  {
    "name": "Taps Products",
    "class": "main-taps",
    "tag": "section",
    "blocks": [
      {
        "name": "Tap",
        "type": "tap",
        "settings": [
          {
              "type": "text",
              "id": "button",
              "label": "Button"
          },
          {
            "type": "richtext",
            "id": "content",
            "label": "Content"
          },
          {
            "type": "image_picker",
            "id": "imagen",
            "label": "Imagen"
          }
        ]
      }
	],
  	"presets": [
      {
        "name": "Taps Product NVY",
        "category": "Custom"
      }
    ]
  }
{% endschema %}